<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<!-- import CSS -->
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<link rel="stylesheet" href="./css/common.css">
	<link rel="stylesheet" href="./css/dropdown.css">
</head>

<body>
	<div id="app" v-cloak>
		<header>
			<ul>
				<li>1</li>
				<li>2</li>
				<li>3</li>
				<li>4</li>
				<li>5</li>
				<li>6</li>
			</ul>
		</header>
		<div class="block"></div>
		<div class="container">
			<el-dropdown trigger="click" placement="bottom" @visible-change="visibleChange">
				<span class="el-dropdown-link">
					下拉菜单<i class="el-icon-arrow-down el-icon--right"></i>
				</span>
				<el-dropdown-menu slot="dropdown">
					<el-input placeholder="输入关键字进行过滤" v-model="filterText">
					</el-input>

					<el-tree class="filter-tree" :data="data" :props="defaultProps" :default-expand-all="false"
						:filter-node-method="filterNode" ref="tree" show-checkbox @node-expand='nodeExpand'
						@check="check">
					</el-tree>
				</el-dropdown-menu>
			</el-dropdown>
		</div>
	</div>
</body>
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="../elementUiTest/script/index.js"></script>
<script>
	const a = new Demo('a')
	console.log(a);

	new Vue({
		el: '#app',
		data: function () {
			return {
				filterText: '',
				data: [{
					id: 1,
					label: '一级 1',
					children: [{
						id: 4,
						label: '二级 1-1',
						children: [{
							id: 9,
							label: '三级 1-1-1'
						}, {
							id: 10,
							label: '三级 1-1-2',
							children: [{
								id: 11,
								label: '四级 1-1-1'
							}, {
								id: 12,
								label: '四级 1-1-2',
								children: [{
									id: 13,
									label: '五级 1-1-1'
								}]
							}]
						}]
					}]
				}, {
					id: 2,
					label: '一级 2',
					children: [{
						id: 5,
						label: '二级 2-1'
					}, {
						id: 6,
						label: '二级 2-2',
						children: [{
								id: 14,
								label: '三级 1-1-1',
								children: [{
									id: 15,
									label: '四级 1-1-1'
								}, {
									id: 16,
									label: '五级 1-1-1',
									children: [{
										id: 17,
										label: '六级 1-1-1'
									}]
								}]
							},
							{
								id: 18,
								label: '三级 1-1-2',
							}
						]
					}]
				}, {
					id: 3,
					label: '一级 3',
					children: [{
						id: 7,
						label: '二级 3-1'
					}, {
						id: 8,
						label: '二级 3-2'
					}]
				}],
				defaultProps: {
					children: 'children',
					label: 'label'
				}
			};
		},
		watch: {
			filterText(val) {
				this.$refs.tree.filter(val);
			}
		},
		methods: {
			filterNode(value, data) {
				if (!value) return true;
				return data.label.indexOf(value) !== -1;
			},

			visibleChange() {
				this.show = !this.show
				console.log(this.show);
				if (!this.show) {
					a.move()
				}
			},
			nodeExpand() {
				console.log('nodeExpand:节点被展开事件');
				a.stop()
			},
			check() {
				console.log('复选框被点击');
				console.log(a.bodyClassList());
				// const result = a.bodyClassList().some(item => {
				// 	item === 'add_stop'
				// })
				// console.log(result, 'true则body有add_stop类');
			}
		},
	})
</script>

</html>